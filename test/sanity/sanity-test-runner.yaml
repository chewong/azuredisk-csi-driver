apiVersion: v1
kind: Pod
metadata:
  name: sanity-test-runner
spec:
  hostNetwork: true
  restartPolicy: Never
  containers:
    - name: sanity-test-runner
      image: <image>
      imagePullPolicy: Always
      resources:
        limits:
          cpu: 200m
          memory: 200Mi
        requests:
          cpu: 10m
          memory: 20Mi
      volumeMounts:
        - mountPath: /etc/kubernetes/
          name: azure-cred
        - mountPath: /devhost # use /devhost to avoid conflict
          name: device-dir
        - mountPath: /sys/bus/scsi/devices
          name: sys-devices-dir
        - mountPath: /sys/class/scsi_host/
          name: scsi-host-dir
      securityContext:
        privileged: true
      env:
        - name: NODEID
          valueFrom:
            fieldRef:
              fieldPath: spec.nodeName
  volumes:
    - hostPath:
        path: /etc/kubernetes/
        type: Directory
      name: azure-cred
    - hostPath:
        path: /dev
        type: Directory
      name: device-dir
    - hostPath:
        path: /sys/bus/scsi/devices
        type: Directory
      name: sys-devices-dir
    - hostPath:
        path: /sys/class/scsi_host/
        type: Directory
      name: scsi-host-dir
